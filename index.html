<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pro Skor Bord</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            background-color: #0f172a; 
            color: white; 
            font-family: sans-serif; 
            margin: 0; 
            /* Yüksekliği sabitlemiyoruz, sayfanın doğal akışına bırakıyoruz */
            overflow-y: auto;
        }

        .header { 
            padding: 15px; 
            background: #1e293b; 
            text-align: center;
            border-bottom: 1px solid #334155;
        }

        .main-container {
            padding: 10px;
            padding-bottom: 50px; /* En altta biraz boşluk bırakalım */
        }

        table { width: 100%; border-collapse: collapse; table-layout: fixed; background: #1e293b; border-radius: 12px; overflow: hidden; }
        
        th { background: #0f172a; padding: 12px 0; color: #93c5fd; font-size: 14px; }
        td { padding: 5px 2px; border-bottom: 1px solid #334155; text-align: center; }
        
        .score-input { 
            width: 90%; 
            padding: 12px 0; 
            border-radius: 8px; 
            border: 2px solid transparent; 
            background: #334155; 
            color: white; 
            text-align: center; 
            font-weight: bold; 
            font-size: 18px;
            outline: none;
        }
        
        .score-input:focus { border-color: #60a5fa; background: #0f172a; }
        .score-input.negative { background: #059669 !important; }
        
        .active-row { background: rgba(59, 130, 246, 0.2); }
        .edit-btn { background: #475569; border: none; color: white; padding: 8px; border-radius: 6px; }

        .total-row { background: #0f172a; color: #fbbf24; font-weight: bold; }
        .total-row td { border-top: 2px solid #60a5fa; padding: 15px 0; font-size: 18px; }

        /* BUTONLARIN OLDUĞU ALT PANEL - ARTIK SABİT DEĞİL */
        .controls-wrapper {
            margin-top: 20px;
            background: #1e293b;
            padding: 15px;
            border-radius: 15px;
            border: 1px solid #334155;
        }

        .multi-btns { display: flex; gap: 6px; margin-bottom: 12px; }
        .btn { flex: 1; padding: 15px 5px; border: none; border-radius: 10px; font-weight: bold; color: white; font-size: 13px; }
        .btn-red { background: #dc2626; }
        .btn-slate { background: #475569; }
        .btn-yellow { background: #ca8a04; }
        .btn-blue { background: #2563eb; }

        .award-section { display: flex; gap: 8px; align-items: center; }
        #awardInput { width: 70px; padding: 12px; border-radius: 10px; border: none; text-align: center; font-size: 18px; background: #334155; color: white; }
        .player-btns { display: flex; gap: 5px; flex: 1; }
        .p-btn { background: #059669; padding: 12px; border-radius: 10px; font-size: 12px; border: none; color: white; flex: 1; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header">
        <h3 style="margin:0; font-style:italic; color:#60a5fa;">PRO SKOR BORD</h3>
    </div>

    <div class="main-container">
        <table>
            <thead>
                <tr>
                    <th style="width: 45px;">Düz.</th>
                    <th>P1</th><th>P2</th><th>P3</th><th>P4</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
            <tfoot>
                <tr class="total-row">
                    <td>TOP</td>
                    <td id="tot0">0</td><td id="tot1">0</td><td id="tot2">0</td><td id="tot3">0</td>
                </tr>
            </tfoot>
        </table>

        <div class="controls-wrapper">
            <div class="multi-btns">
                <button class="btn btn-red" onclick="applyMulti(4)">4x</button>
                <button class="btn btn-slate" onclick="applyMulti(5)">5x</button>
                <button class="btn btn-yellow" onclick="applyMulti(6)">6x</button>
                <button class="btn btn-blue" onclick="applyMulti(7)">7x</button>
                <button class="btn btn-red" style="flex:0.4" onclick="resetGame()">SİL</button>
            </div>
            <div class="award-section">
                <input type="number" id="awardInput" placeholder="Ödül" inputmode="numeric">
                <div class="player-btns">
                    <button class="p-btn" onclick="addAward(0)">P1</button>
                    <button class="p-btn" onclick="addAward(1)">P2</button>
                    <button class="p-btn" onclick="addAward(2)">P3</button>
                    <button class="p-btn" onclick="addAward(3)">P4</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let activeRow = 0;
        const totalRows = 11;

        function initTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            for (let i = 0; i < totalRows; i++) {
                const tr = document.createElement('tr');
                tr.id = 'row-' + i;
                if (i === activeRow) tr.className = 'active-row';
                tr.innerHTML = `<td><button class="edit-btn" onclick="setEditRow(${i})">✍️</button></td>` + 
                    [0,1,2,3].map(p => `<td><input type="number" inputmode="numeric" class="score-input" id="r${i}p${p}" onfocus="highlightRow(${i})" oninput="calculateTotals()"></td>`).join('');
                tbody.appendChild(tr);
            }
        }

        function highlightRow(idx) {
            document.querySelectorAll('tr').forEach(r => r.classList.remove('active-row'));
            activeRow = idx;
            document.getElementById('row-' + idx).classList.add('active-row');
        }

        function setEditRow(idx) {
            highlightRow(idx);
            document.getElementById(`r${idx}p0`).focus();
        }

        function calculateTotals() {
            for (let p = 0; p < 4; p++) {
                let sum = 0;
                for (let r = 0; r < totalRows; r++) {
                    let val = parseInt(document.getElementById(`r${r}p${p}`).value) || 0;
                    sum += val;
                    document.getElementById(`r${r}p${p}`).classList.toggle('negative', val < 0);
                }
                document.getElementById('tot' + p).innerText = sum;
            }
        }

        function applyMulti(m) {
            for (let p = 0; p < 4; p++) {
                const input = document.getElementById(`r${activeRow}p${p}`);
                let val = parseInt(input.value) || 0;
                if (val > 0) input.value = val * m;
            }
            calculateTotals();
            if(activeRow < totalRows - 1) setEditRow(activeRow + 1);
        }

        function addAward(pIdx) {
            const award = document.getElementById('awardInput').value;
            if (!award) return;
            document.getElementById(`r${activeRow}p${pIdx}`).value = -Math.abs(parseInt(award));
            calculateTotals();
            document.getElementById('awardInput').value = '';
        }

        function resetGame() { if(confirm("Sıfırlansın mı?")) location.reload(); }

        initTable();
    </script>
</body>
</html>